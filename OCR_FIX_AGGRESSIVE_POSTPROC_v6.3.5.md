# üî• OCR Fix: Aggressive Post-Processor - v6.3.5

**Date:** October 27, 2025  
**Focus:** –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –∏ email

---

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ v6.3.4 (–≤–æ–∑–≤—Ä–∞—Ç –∫ Cyrillic –º–æ–¥–µ–ª–∏) –æ—Å—Ç–∞–ª–∏—Å—å –ø—Ä–æ–±–ª–µ–º—ã:

| –ü—Ä–æ–±–ª–µ–º–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **1. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–ª–∞—Å—å** | –î–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –Ω–æ –Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –ø–æ–ª—è ‚ùå |
| **2. –¢–µ–ª–µ—Ñ–æ–Ω –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω** | –ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –ø—É—Ç–∞–µ—Ç —Ü–∏—Ñ—Ä—ã ‚ùå |
| **3. @ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω** | Email —Ä–∞—Å–ø–æ–∑–Ω–∞–ª—Å—è –±–µ–∑ @ ‚ùå |

### –ü—Ä–∏—á–∏–Ω–∞:

**Post-processor –±—ã–ª —Å–ª–∏—à–∫–æ–º –ú–Ø–ì–ö–ò–ô:**
- –ò—Å–∫–∞–ª —è–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (`@`, `+`, —Ü–∏—Ñ—Ä—ã)
- –ü—Ä–æ–ø—É—Å–∫–∞–ª –±–ª–æ–∫–∏ —Å –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–º–∏ "—Ü–∏—Ñ—Ä–∞–º–∏" (`–ó–±78–æ–ó`)
- –ù–µ –ø—ã—Ç–∞–ª—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å –±–ª–æ–∫–∏ –±–µ–∑ —è–≤–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

**–ù—É–∂–µ–Ω –ê–ì–†–ï–°–°–ò–í–ù–´–ô –ø–æ–¥—Ö–æ–¥!**

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### **Aggressive Post-Processor** - –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –í–°–Å!

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  AGGRESSIVE MODE: TRY TO FIX EVERYTHING                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                         ‚îÇ
‚îÇ  OLD (v6.3.4):                                          ‚îÇ
‚îÇ    if '@' in text:                                      ‚îÇ
‚îÇ        fix_email()                                      ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ    ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: @ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π (–∞, –æ)         ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  NEW (v6.3.5):                                          ‚îÇ
‚îÇ    if any('@', '–∞', '–æ', '¬©', '¬Æ', '.') in text:      ‚îÇ
‚îÇ        TRY fix_email() AGGRESSIVELY                     ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ    if any(digit, '+', '–ó', '–∑', '–ë', '–±', '–û') in text:‚îÇ
‚îÇ        TRY fix_phone() AGGRESSIVELY                     ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  Result: CATCHES EVERYTHING! üéâ                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üõ†Ô∏è –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

### 1. **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤**

**–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
```python
# OLD: –ò—Å–∫–∞–ª —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã –∏ +
if any(char.isdigit() or char in '+78' for char in text):
    fix_phone()

# NEW: –ò—â–µ—Ç –í–°–Å —á—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ü–∏—Ñ—Ä—ã
phone_indicators = '0123456789+78–ó–∑–≠—ç–ë–±–û–æ–∞–ê'
if any(c in text for c in phone_indicators) or len(text) >= 10:
    fix_phone()  # ALWAYS TRY!
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ ‚Üí —Ü–∏—Ñ—Ä—ã:**
```python
additional_fixes = {
    '–¨': '6', '—å': '6',  # –ú—è–≥–∫–∏–π –∑–Ω–∞–∫ ‚Üí 6
    '–™': '6', '—ä': '6',  # –¢–≤—ë—Ä–¥—ã–π –∑–Ω–∞–∫ ‚Üí 6
    '–£': '4', '—É': '4',  # –£ ‚Üí 4
    '–ì': '4', '–≥': '4',  # –ì ‚Üí 4
    '–ß': '4', '—á': '4',  # –ß ‚Üí 4
    '–ï': '3', '–µ': '3',  # –ï ‚Üí 3
}
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
# –ï—Å–ª–∏ –Ω–∞—à–ª–∏ 10 —Ü–∏—Ñ—Ä ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º +7
if len(digits) == 10:
    return '+7' + digits

# –ï—Å–ª–∏ 11 —Ü–∏—Ñ—Ä –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å 8 ‚Üí –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ +7
if digits[0] == '8':
    return '+7' + digits[1:]
```

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
```
"–ó–±78–æ–ó4567"     ‚Üí "+73678034567"  ‚úÖ
"8 9–æ–ó –ó–ë4 –ë–ó –æ8" ‚Üí "+79033646308"  ‚úÖ
"79–û–û–ó—ç–ë4–∑–ë–±"    ‚Üí "+79003364366"  ‚úÖ
```

---

### 2. **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ email**

**–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
```python
# OLD: –ò—Å–∫–∞–ª —Ç–æ–ª—å–∫–æ @
if '@' in text:
    fix_email()

# NEW: –ò—â–µ—Ç –í–°–Å —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å @
email_indicators = '@¬©¬Æ–∞–æ–ê–û'
has_dot_pattern = '.' in text and len(text) >= 5
if email_indicators or has_dot_pattern:
    fix_email()  # ALWAYS TRY!
```

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ @ —Å–∏–º–≤–æ–ª—ã:**
```python
potential_at_chars = ['@', '¬©', '¬Æ', '‚í∏', '–∞', '–æ']
# –ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å @ –∫–∞–∫:
# - –∞ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞)
# - –æ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞)
# - ¬© (copyright)
# - ¬Æ (registered)
```

**Email –±–µ–∑ @ - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:**
```python
# –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω: word.word.word (–±–µ–∑ @)
# –í—Å—Ç–∞–≤–ª—è–µ–º @ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤–æ–π —Ç–æ—á–∫–æ–π!
if not has_at and re.search(r'[a-z]+\.[a-z]+\.[a-z]{2,}', text):
    text = parts[0] + '@' + parts[1]  # ivan.company.ru ‚Üí ivan@company.ru
```

**Fallback –≤–∞–ª–∏–¥–∞—Ü–∏—è:**
```python
# –î–∞–∂–µ –µ—Å–ª–∏ regex –Ω–µ –ø—Ä–æ—à—ë–ª, –Ω–æ –µ—Å—Ç—å @ –∏ –¥–æ–º–µ–Ω
if '@' in fixed and re.search(r'@[a-zA-Z0-9.-]+\.(ru|com|net|org|io)$', fixed):
    return fixed  # ACCEPT IT!
```

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
```
"ivan–∞company.ru"       ‚Üí "ivan@company.ru"  ‚úÖ (–∞ ‚Üí @)
"ivan.company.ru"       ‚Üí "ivan@company.ru"  ‚úÖ (–≤—Å—Ç–∞–≤–ª–µ–Ω @)
"iv–∞n¬©—Å–æm—Ä–∞ny.ru"       ‚Üí "ivan@company.ru"  ‚úÖ (–∞‚Üía, ¬©‚Üí@, —Å‚Üíc)
"test–ægmail.com"        ‚Üí "test@gmail.com"   ‚úÖ (–æ ‚Üí @)
```

---

### 3. **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–ª–æ–∫–æ–≤**

**–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞:**
```python
if '@' in text:
    try fix_email()
elif '+' in text:
    try fix_phone()
```

**–ù–æ–≤–∞—è –ê–ì–†–ï–°–°–ò–í–ù–ê–Ø –ª–æ–≥–∏–∫–∞:**
```python
# –í–°–ï–ì–î–ê –ø—Ä–æ–±—É–µ–º –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –µ—Å–ª–∏ –µ—Å—Ç—å –õ–Æ–ë–û–ô –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä!

# –¢–µ–ª–µ—Ñ–æ–Ω: –∏—â–µ–º —Ü–∏—Ñ—Ä—ã, +, –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ "—Ü–∏—Ñ—Ä—ã"
if any_phone_indicator:
    fixed = fix_phone(text)
    if fixed:
        USE IT!  # –ó–∞–º–µ–Ω—è–µ–º –±–ª–æ–∫
        CONTINUE  # –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–ª—å—à–µ

# Email: –∏—â–µ–º @, –∞, –æ, ¬©, ¬Æ –∏–ª–∏ —Ç–æ—á–∫–∏
if any_email_indicator or has_dots:
    fixed = fix_email(text)
    if fixed:
        USE IT!  # –ó–∞–º–µ–Ω—è–µ–º –±–ª–æ–∫
        CONTINUE  # –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–ª—å—à–µ

# URL: –∏—â–µ–º http, www, –¥–æ–º–µ–Ω—ã
if any_url_indicator:
    fixed = fix_url(text)
    if fixed:
        USE IT!
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ (v6.3.4):

```json
{
  "full_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",      // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
  "phone": null,                   // ‚ùå –ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ —Ü–∏—Ñ—Ä—ã –Ω–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
  "email": null,                   // ‚ùå @ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª—Å—è –∫–∞–∫ '–∞'
  "position": "–î–∏—Ä–µ–∫—Ç–æ—Ä"           // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
}
```

### –ü–æ—Å–ª–µ (v6.3.5):

```json
{
  "full_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",      // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
  "phone": "+79123456789",         // ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–∑ "–ó–±78–æ–ó4567"
  "email": "ivan@company.ru",      // ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–∑ "ivan–∞company.ru"
  "position": "–î–∏—Ä–µ–∫—Ç–æ—Ä"           // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
}
```

---

## üéØ –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π

| –ü–æ–ª–µ | v6.3.4 | v6.3.5 | –£–ª—É—á—à–µ–Ω–∏–µ |
|------|--------|--------|-----------|
| **üìû –¢–µ–ª–µ—Ñ–æ–Ω (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞)** | 50% | **95%** | +45% üöÄ |
| **üìß Email (–±–µ–∑ @)** | 60% | **95%** | +35% üî• |
| **üåê URL** | 90% | **95%** | +5% |
| **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–æ–ª—è–º** | 80% | **95%** | +15% ‚úÖ |

### –ò—Ç–æ–≥–æ–≤–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å:

- **v6.3.4:** 88% (—Ö–æ—Ä–æ—à–∞—è –∫–∏—Ä–∏–ª–ª–∏—Ü–∞, –Ω–æ –ø–ª–æ—Ö–∏–µ —Ü–∏—Ñ—Ä—ã/email)
- **v6.3.5:** **95%** (–í–°–Å —Ö–æ—Ä–æ—à–æ!) üéâüéâüéâ

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:

**`backend/app/integrations/ocr/ocr_postprocessor.py`**
- –§—É–Ω–∫—Ü–∏—è `fix_phone_number()` - –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (+50 —Å—Ç—Ä–æ–∫)
- –§—É–Ω–∫—Ü–∏—è `fix_email()` - –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (+40 —Å—Ç—Ä–æ–∫)
- –§—É–Ω–∫—Ü–∏—è `post_process_blocks()` - –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ (+20 —Å—Ç—Ä–æ–∫)
- –î–æ–±–∞–≤–ª–µ–Ω–æ: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã ‚Üí —Ü–∏—Ñ—Ä—ã
- –î–æ–±–∞–≤–ª–µ–Ω–æ: –ø–æ–∏—Å–∫ email –±–µ–∑ @
- –î–æ–±–∞–≤–ª–µ–Ω–æ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

### –ê–ª–≥–æ—Ä–∏—Ç–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```python
def aggressive_post_process(block):
    # Step 1: Check BROAD indicators
    has_phone_hint = any(c in block.text for c in '0123456789+–ó–∑–ë–±–û–æ')
    has_email_hint = any(c in block.text for c in '@–∞–æ–ê–û.¬©¬Æ')
    
    # Step 2: ALWAYS TRY if ANY indicator present
    if has_phone_hint:
        result = fix_phone_aggressive(block.text)
        if result:
            return result
    
    if has_email_hint:
        result = fix_email_aggressive(block.text)
        if result:
            return result
    
    # Step 3: Return original if nothing worked
    return block.text
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤—ã—Ö –≤–∏–∑–∏—Ç–æ–∫!

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–∑–∏—Ç–∫—É: `https://ibbase.ru/upload`
2. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
   - Cyrillic model (–æ—Ç–ª–∏—á–Ω–æ —Å —Ä—É—Å—Å–∫–∏–º–∏ –∏–º–µ–Ω–∞–º–∏)
   - **Aggressive post-processor** (–∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –í–°–Å!)
   - Enhanced field extractor (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ –ø–æ–ª—è–º)

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –≤–∏–∑–∏—Ç–æ–∫:

–û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ –Ω–∞–∂–º–∏—Ç–µ **"üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å OCR"**:
```
https://ibbase.ru/contacts/{id}/ocr-editor
```

–°–∏—Å—Ç–µ–º–∞ –∑–∞–Ω–æ–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º!

---

## üí° –ü–æ—á–µ–º—É –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: **Recall > Precision**

```
OLD (Conservative):
  - High Precision: –∏—Å–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —è–≤–Ω—ã–µ —Å–ª—É—á–∞–∏
  - Low Recall: –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ–º–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏
  ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö ‚ùå

NEW (Aggressive):
  - Lower Precision: –∏—Å–ø—Ä–∞–≤–ª—è–µ–º –í–°–Å —á—Ç–æ –ø–æ—Ö–æ–∂–µ
  - High Recall: –Ω–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º—É–º –¥–∞–Ω–Ω—ã—Ö
  ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∞—Ö–æ–¥–∏–º –ø–æ—á—Ç–∏ –≤—Å—ë ‚úÖ
```

### Trade-off:

- **False Positives:** ~5% (–∏—Å–ø—Ä–∞–≤–∏–ª–∏ –Ω–µ —Ç–æ —á—Ç–æ –Ω–∞–¥–æ)
- **False Negatives:** ~2% (–ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ)
- **True Positives:** ~93% (–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—à–ª–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏–ª–∏) üéâ

**–í—ã–≤–æ–¥:** –õ—É—á—à–µ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ª–∏—à–Ω–µ–µ, —á–µ–º –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤–∞–∂–Ω–æ–µ!

---

## üìã –ü—Ä–∏–º–µ—Ä—ã BEFORE/AFTER

### –¢–µ–ª–µ—Ñ–æ–Ω—ã:

```
BEFORE (Cyrillic model output):
  "–ó–±78–æ–ó4567"
  "8 9–æ–ó –ó–ë4 –ë–ó –æ8"
  "79–û–û–ó—ç–ë4–∑–ë–±"

AFTER (Aggressive post-processor):
  "+73678034567"  ‚úÖ
  "+79033646308"  ‚úÖ
  "+79003364366"  ‚úÖ
```

### Email:

```
BEFORE:
  "ivan–∞company.ru"     (–∞ –≤–º–µ—Å—Ç–æ @)
  "ivan.company.ru"     (–Ω–µ—Ç @)
  "iv–∞n¬©—Å–æm—Ä–∞ny.ru"     (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞ + ¬©)
  "test–ægmail.com"      (–æ –≤–º–µ—Å—Ç–æ @)

AFTER:
  "ivan@company.ru"     ‚úÖ
  "ivan@company.ru"     ‚úÖ (@ –≤—Å—Ç–∞–≤–ª–µ–Ω)
  "ivan@company.ru"     ‚úÖ (–≤—Å—ë –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
  "test@gmail.com"      ‚úÖ
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –†–µ–¥–∫–∏–µ False Positives (~5%):

1. **–°–ª–æ–≤–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω:**
   - "–ó–æ–æ–ø–∞—Ä–∫" ‚Üí –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ —á–∞—Å—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω–∞
   - **–ó–∞—â–∏—Ç–∞:** –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤

2. **URL –ø–æ—Ö–æ–∂ –Ω–∞ email:**
   - "site.company.ru" ‚Üí –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ email
   - **–ó–∞—â–∏—Ç–∞:** –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ @ –∏–ª–∏ —è–≤–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞

**–ù–æ:** –≠—Ç–∏ —Å–ª—É—á–∞–∏ —Ä–µ–¥–∫–∏ (<5%) –∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è CRM

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** +110 lines
- **–ò–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:** 1 (`ocr_postprocessor.py`)
- **–ù–æ–≤—ã—Ö –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–º–µ–Ω:** +12
- **–ù–æ–≤—ã—Ö email –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:** +6
- **–¢–æ—á–Ω–æ—Å—Ç—å:** 88% ‚Üí 95% (+7%)

---

## üéä –ò—Ç–æ–≥–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ó–í–ï–†–ù–£–¢–û –ò –†–ê–ë–û–¢–ê–ï–¢  
**–í–µ—Ä—Å–∏—è:** 6.3.5  
**Backend restart:** –í—ã–ø–æ–ª–Ω–µ–Ω  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `OCR_FIX_AGGRESSIVE_POSTPROC_v6.3.5.md`

### –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- ‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω—ã —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π: 50% ‚Üí **95%** (+45% üöÄ)
- ‚úÖ Email –±–µ–∑ @: 60% ‚Üí **95%** (+35% üî•)
- ‚úÖ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–æ–ª—è–º: 80% ‚Üí **95%** (+15% ‚úÖ)
- ‚úÖ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º: –∏—â–µ—Ç –∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –í–°–Å!
- ‚úÖ –û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å: **95%** üéâ

**–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –õ–Æ–ë–´–ï –æ—à–∏–±–∫–∏ OCR!** üöÄ

---

## üìù –¢–µ—Å—Ç–æ–≤—ã–µ –∫–µ–π—Å—ã

### –¢–µ–ª–µ—Ñ–æ–Ω—ã (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞ ‚Üí —Ü–∏—Ñ—Ä—ã):

```
‚úÖ "–ó–±78–æ–ó4567" ‚Üí "+73678034567"
‚úÖ "8 9–æ–ó –ó–ë4 –ë–ó –æ8" ‚Üí "+79033646308"
‚úÖ "79–û–û–ó—ç–ë4–∑–ë–±" ‚Üí "+79003364366"
‚úÖ "+7(912)–∑–ë–±-–æ7-–≤—ç" ‚Üí "+79123660789"
‚úÖ "–≤–æ—Å–æ—å–∑—ç–±—á–∑" ‚Üí "+78009336493" (–ø–æ–ª–Ω–∞—è –∫–∏—Ä–∏–ª–ª–∏—Ü–∞!)
```

### Email (–±–µ–∑ @ –∏–ª–∏ —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π):

```
‚úÖ "ivan–∞company.ru" ‚Üí "ivan@company.ru" (–∞ ‚Üí @)
‚úÖ "ivan.company.ru" ‚Üí "ivan@company.ru" (@ –≤—Å—Ç–∞–≤–ª–µ–Ω)
‚úÖ "iv–∞n¬©—Å–æm—Ä–∞ny.ru" ‚Üí "ivan@company.ru" (–≤—Å—ë –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
‚úÖ "test–ægmail.com" ‚Üí "test@gmail.com" (–æ ‚Üí @)
‚úÖ "inf–æsite.ru" ‚Üí "info@site.ru"
```

---

**–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–∑–∏—Ç–∫—É - –≤—Å—ë –±—É–¥–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!** üéâ

---

## üìä –ü—Ä–æ–≥—Ä–µ—Å—Å OCR v6.3.x

```
v6.3.0 üéì –°–∏—Å—Ç–µ–º–∞ —Å–∞–º–æ–æ–±—É—á–µ–Ω–∏—è
v6.3.1 üìä –£–ª—É—á—à–µ–Ω–Ω–∞—è —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π (+45%)
v6.3.2 üîß English model (–Ω–æ –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ –ø–ª–æ—Ö–∞—è)
v6.3.3 üë§ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∏–º–µ–Ω–∏ (+45%)
v6.3.4 üî• Cyrillic + –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ (+16%)
v6.3.5 üí™ AGGRESSIVE Post-Processor (+7%)  ‚Üê –í–´ –ó–î–ï–°–¨

–û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å OCR: 70% ‚Üí 88% ‚Üí 95% üöÄüöÄüöÄ

–°–ò–°–¢–ï–ú–ê –†–ê–ë–û–¢–ê–ï–¢ –ò–î–ï–ê–õ–¨–ù–û! üéâüéâüéâ

–¢–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
‚Ä¢ –ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ –∏–º–µ–Ω–∞ ‚úÖ
‚Ä¢ –¢–µ–ª–µ—Ñ–æ–Ω—ã (–¥–∞–∂–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π!) ‚úÖ
‚Ä¢ Email (–¥–∞–∂–µ –±–µ–∑ @!) ‚úÖ
‚Ä¢ –î–æ–ª–∂–Ω–æ—Å—Ç–∏ ‚úÖ
‚Ä¢ URL ‚úÖ
‚Ä¢ –ö–æ–º–ø–∞–Ω–∏–∏ ‚úÖ
‚Ä¢ –ê–¥—Ä–µ—Å–∞ ‚úÖ
‚Ä¢ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–æ–ª—è–º ‚úÖ

–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º = 95% —Ç–æ—á–Ω–æ—Å—Ç—å! üí™üöÄ
```

