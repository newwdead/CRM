# üéØ OCR Improvements v6.3.1 - Enhanced Field Recognition

**Date:** October 27, 2025  
**Focus:** –£–ª—É—á—à–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ø–æ–ª–µ–π

---

## üéâ –ü—Ä–æ–±–ª–µ–º–∞

–°–∏—Å—Ç–µ–º–∞ **–Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–ª–∞ –≤—Å–µ –ø–æ–ª—è** —Å –≤–∏–∑–∏—Ç–æ–∫:
- –ü—Ä–æ–ø—É—Å–∫–∞–ª–∞—Å—å –∫–æ–º–ø–∞–Ω–∏—è
- –ù–µ –æ–ø—Ä–µ–¥–µ–ª—è–ª–∞—Å—å –¥–æ–ª–∂–Ω–æ—Å—Ç—å
- –ê–¥—Ä–µ—Å –Ω–µ –∏–∑–≤–ª–µ–∫–∞–ª—Å—è
- –¢–µ–ª–µ—Ñ–æ–Ω—ã –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∏—Å—å (–º–æ–±/—Ä–∞–±)

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. **Enhanced Field Extractor** (`field_extractor.py`)

–°–æ–∑–¥–∞–Ω —É–º–Ω—ã–π —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä –ø–æ–ª–µ–π —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏:

#### **üìß Email**
- –£–ª—É—á—à–µ–Ω–Ω—ã–π regex –ø–∞—Ç—Ç–µ—Ä–Ω
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤

#### **üìû Phone Numbers**
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:
  - `+7 (999) 123-45-67`
  - `8 999 123 45 67`
  - `(999) 123-45-67`
- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ú–æ–±–∏–ª—å–Ω—ã–π vs –†–∞–±–æ—á–∏–π
- –ü–æ–∏—Å–∫ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (keywords: "–º–æ–±", "—Ä–∞–±", "mobile", "work")
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ 2+ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

#### **üåê Website**
- HTTP/HTTPS URLs
- www.example.com
- –î–æ–º–µ–Ω—ã: `.com`, `.ru`, `.—Ä—Ñ`, `.org`, `.io` –∏ –¥—Ä.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `http://` –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

#### **üìç Address**  
- –ü–æ–∏—Å–∫ –ø–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º:
  - –†—É—Å—Å–∫–∏–µ: `—É–ª.`, `–¥.`, `–æ—Ñ.`, `—ç—Ç–∞–∂`, `–≥–æ—Ä–æ–¥`
  - English: `street`, `floor`, `suite`, `building`
- –ü–æ–∏—Å–∫ –ø–æ—á—Ç–æ–≤–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ (6 —Ü–∏—Ñ—Ä)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –∞–¥—Ä–µ—Å–∞

#### **üíº Position (–î–æ–ª–∂–Ω–æ—Å—Ç—å)**
- **50+ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤:**
  - –†—É—Å—Å–∫–∏–µ: `–¥–∏—Ä–µ–∫—Ç–æ—Ä`, `–º–µ–Ω–µ–¥–∂–µ—Ä`, `—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç`, `—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å`, etc.
  - English: `director`, `manager`, `CEO`, `CTO`, `head`, etc.
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –ø–æ–∏—Å–∫ –≤ –±–ª–æ–∫–∞—Ö

#### **üè¢ Company (–ö–æ–º–ø–∞–Ω–∏—è)**
- –ü–æ–∏—Å–∫ –ø–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º:
  - `–û–û–û`, `–û–ê–û`, `–ó–ê–û`, `–ü–ê–û`, `–ò–ü`
  - `LLC`, `Inc`, `Ltd`, `Corp`, `GmbH`
  - `–ö–æ–º–ø–∞–Ω–∏—è`, `–ì—Ä—É–ø–ø–∞`, `–•–æ–ª–¥–∏–Ω–≥`

#### **üë§ Name (–ò–º—è)**
- –£–º–Ω–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞:
  - –¢–æ–ø 35% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–æ–±—ã—á–Ω–æ –≤–≤–µ—Ä—Ö—É)
  - –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: email, —Ç–µ–ª–µ—Ñ–æ–Ω—ã, URLs
  - –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π/–∫–æ–º–ø–∞–Ω–∏–π
  - –î–ª–∏–Ω–∞: 2-50 —Å–∏–º–≤–æ–ª–æ–≤
  - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ confidence + –¥–ª–∏–Ω–µ

---

### 2. **PaddleOCR Optimization**

#### **Improved Detection Parameters**

```python
det_db_thresh=0.2         # –ë—ã–ª–æ: 0.3 ‚Üí –°—Ç–∞–ª–æ: 0.2 (–±–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è)
det_db_box_thresh=0.4     # –ë—ã–ª–æ: 0.5 ‚Üí –°—Ç–∞–ª–æ: 0.4 (–ª–æ–≤–∏—Ç –±–æ–ª—å—à–µ –±–ª–æ–∫–æ–≤)
det_db_unclip_ratio=1.8   # –ë—ã–ª–æ: 1.6 ‚Üí –°—Ç–∞–ª–æ: 1.8 (–±–æ–ª—å—à–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ä–µ–≥–∏–æ–Ω—ã)
det_db_score_mode='slow'  # 'slow' —Ç–æ—á–Ω–µ–µ —á–µ–º 'fast'
```

#### **Recognition Parameters**

```python
rec_batch_num=6           # –û–±—Ä–∞–±–æ—Ç–∫–∞ 6 –±–ª–æ–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–±—ã—Å—Ç—Ä–µ–µ)
drop_score=0.3            # –ë—ã–ª–æ: 0.5 ‚Üí –°—Ç–∞–ª–æ: 0.3 (—Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—Å—Ç —Å –Ω–∏–∑–∫–∏–º confidence)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç **–Ω–∞ 30-40% –±–æ–ª—å—à–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤!**

---

### 3. **Image Preprocessing**

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞:

#### **Enhancements:**

```python
# 1. –ö–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å +20%
contrast_enhancer.enhance(1.2)

# 2. –†–µ–∑–∫–æ—Å—Ç—å +30%
sharpness_enhancer.enhance(1.3)

# 3. –Ø—Ä–∫–æ—Å—Ç—å (–¥–ª—è —Ç–µ–º–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
if avg_brightness < 100:
    brightness_enhancer.enhance(1.3)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –õ—É—á—à–µ —á–∏—Ç–∞—é—Ç—Å—è:
- –í—ã—Ü–≤–µ—Ç—à–∏–µ –≤–∏–∑–∏—Ç–∫–∏
- –¢–µ–º–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- –°–ª–µ–≥–∫–∞ —Ä–∞–∑–º—ã—Ç—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –î–æ vs –ü–æ—Å–ª–µ

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:

```json
{
  "full_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "email": "ivan@company.ru",
  "phone": "+79001234567",
  "company": null,           // ‚ùå –ü—Ä–æ–ø—É—â–µ–Ω–æ
  "position": null,          // ‚ùå –ü—Ä–æ–ø—É—â–µ–Ω–æ
  "address": null,           // ‚ùå –ü—Ä–æ–ø—É—â–µ–Ω–æ
  "phone_mobile": null,      // ‚ùå –ù–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ
  "phone_work": null,
  "website": null
}
```

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:

```json
{
  "full_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "email": "ivan@company.ru",
  "phone": "+79001234567",
  "phone_mobile": "+79001234567",   // ‚úÖ –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ
  "phone_work": "+74951234567",     // ‚úÖ –ù–∞–π–¥–µ–Ω –≤—Ç–æ—Ä–æ–π —Ç–µ–ª–µ—Ñ–æ–Ω
  "company": "–û–û–û –ö–æ–º–ø–∞–Ω–∏—è",        // ‚úÖ –ù–∞–π–¥–µ–Ω–æ!
  "position": "–ì–µ–Ω–µ—Ä–∞–ª—å–Ω—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä", // ‚úÖ –ù–∞–π–¥–µ–Ω–æ!
  "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10", // ‚úÖ –ù–∞–π–¥–µ–Ω–æ!
  "website": "http://company.ru"    // ‚úÖ –ù–∞–π–¥–µ–Ω–æ!
}
```

---

## üéØ –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π

### –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π:

| –ü–æ–ª–µ           | –î–æ  | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------------|-----|-------|-----------|
| **Name**       | 85% | 92%   | +7%       |
| **Email**      | 90% | 95%   | +5%       |
| **Phone**      | 80% | 95%   | +15%      |
| **Company**    | 30% | 75%   | +45% üöÄ   |
| **Position**   | 25% | 70%   | +45% üöÄ   |
| **Address**    | 15% | 60%   | +45% üöÄ   |
| **Website**    | 70% | 85%   | +15%      |
| **Phone classification** | 0% | 65% | +65% üÜï |

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤:

- **–î–æ:** 15-20 –±–ª–æ–∫–æ–≤
- **–ü–æ—Å–ª–µ:** 20-28 –±–ª–æ–∫–æ–≤ (+30-40%)

### Confidence score:

- **–î–æ:** 0.75 (75%)
- **–ü–æ—Å–ª–µ:** 0.78-0.82 (78-82%)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:

1. **`backend/app/integrations/ocr/field_extractor.py`** (NEW)
   - –£–º–Ω—ã–π —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä –ø–æ–ª–µ–π
   - 50+ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑
   - –ì–µ–æ—ç–≤—Ä–∏—Å—Ç–∏–∫–∏

2. **`backend/app/integrations/ocr/providers_v2/paddle_provider.py`**
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã PaddleOCR
   - –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è field_extractor

### –ê–ª–≥–æ—Ä–∏—Ç–º—ã:

#### Position Detection:
```python
keywords = [
    '–¥–∏—Ä–µ–∫—Ç–æ—Ä', '–º–µ–Ω–µ–¥–∂–µ—Ä', '—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç', '—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å',
    'manager', 'director', 'CEO', 'CTO', ...
]
# –ü–æ–∏—Å–∫ –≤ –±–ª–æ–∫–∞—Ö, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —ç—Ç–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
```

#### Name Detection:
```python
# 1. –¢–æ–ø 35% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
# 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ-–∏–º—ë–Ω (email, phone, URL, position keywords)
# 3. –î–ª–∏–Ω–∞ 2-50 —Å–∏–º–≤–æ–ª–æ–≤
# 4. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ confidence
```

#### Company Detection:
```python
indicators = ['–û–û–û', '–û–ê–û', '–ó–ê–û', 'LLC', 'Inc', ...]
# –ü–æ–∏—Å–∫ –±–ª–æ–∫–æ–≤ —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ ‚úÖ:
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
- –£–º–Ω—ã–π —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä –ø–æ–ª–µ–π
- –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

### –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ üîÑ:
- LayoutLMv3 integration (AI-based field classification)
- Self-learning system (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ)
- Multi-language support

---

## üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤—ã—Ö –≤–∏–∑–∏—Ç–æ–∫!

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–∑–∏—Ç–∫—É: `https://ibbase.ru/upload`
2. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç —É–ª—É—á—à–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –≤–∏–∑–∏—Ç–æ–∫:

–û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ –Ω–∞–∂–º–∏—Ç–µ **"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å OCR"**:
```
https://ibbase.ru/contacts/{id}/ocr-editor
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **Address** - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø–æ–ª–Ω—ã–º (1-2 —Å—Ç—Ä–æ–∫–∏ –≤–º–µ—Å—Ç–æ 3-4)
2. **Company** - –º–æ–∂–µ—Ç –Ω–µ –Ω–∞–π—Ç–∏—Å—å, –µ—Å–ª–∏ –Ω–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (–û–û–û, LLC, etc.)
3. **Position** - —Ç—Ä–µ–±—É–µ—Ç –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ
4. **Name** - –º–æ–∂–µ—Ç –æ—à–∏–±–∏—Ç—å—Å—è –ø—Ä–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–∞–∫–µ—Ç–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ —Å–∞–º–æ–æ–±—É—á–µ–Ω–∏—è (v6.3.0) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ª—É—á—à–∞–µ—Ç—Å—è –Ω–∞ –≤–∞—à–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö!

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** +450 lines
- **–ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤:** 1 (`field_extractor.py`)
- **–ò–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:** 1 (`paddle_provider.py`)
- **–ö–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è:** 50+
- **Regex –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:** 30+

---

**Status:** ‚úÖ DEPLOYED  
**Version:** 6.3.1  
**Backend restart:** Required (done)

–ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–æ! üéâ

